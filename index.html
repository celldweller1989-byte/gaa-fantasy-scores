<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GAA Fantasy League</title>
    <style>
        body { font-family: sans-serif; background: #f4f7f6; padding: 20px; }
        .container { max-width: 900px; margin: auto; background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        h1 { color: #003366; text-align: center; border-bottom: 2px solid #003366; padding-bottom: 10px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 12px; border: 1px solid #eee; text-align: left; }
        th { background-color: #003366; color: white; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        .score { font-weight: bold; color: #2d6a4f; }
        #error-msg { color: red; text-align: center; padding: 10px; display: none; border: 1px solid red; margin-bottom: 10px; }
    </style>
</head>
<body>

<div class="container">
    <h1>üèÜ GAA Fantasy Leaderboard</h1>
    <div id="error-msg"></div>
    <table id="fantasyTable">
        <thead>
            <tr>
                <th>Player</th>
                <th>County</th>
                <th>Pos</th>
                <th>Goals</th>
                <th>Points</th>
                <th>Total</th>
            </tr>
        </thead>
        <tbody id="tableBody">
            <tr><td colspan="6" style="text-align:center;">Fetching latest scores...</td></tr>
        </tbody>
    </table>
</div>

<script>
    // Your verified link with the gid=0 specific tab ID
    const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTcdzjZ4zYlGgFe5acS8xOb1vHR9b8i98UudIOe-iC9Z1d6x6AY5zATgX217cNjcNtAGDLJ56y8Jr8N/pub?gid=0&single=true&output=csv';

    async function loadFantasyData() {
        const tableBody = document.getElementById('tableBody');
        const errorMsg = document.getElementById('error-msg');

        try {
            // We use a timestamp to prevent the browser from showing "old" data
            const response = await fetch(csvUrl + '&cache=' + new Date().getTime());
            if (!response.ok) throw new Error("Could not reach Google Sheets");

            const data = await response.text();
            const rows = data.split('\n').slice(1); // Skip the header row

            tableBody.innerHTML = ''; // Clear the loading message

            rows.forEach(row => {
                const cols = row.split(',');
                if (cols.length >= 5) {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${cols[0].replace(/"/g, '')}</td>
                        <td>${cols[1].replace(/"/g, '')}</td>
                        <td>${cols[2].replace(/"/g, '')}</td>
                        <td>${cols[3].replace(/"/g, '')}</td>
                        <td>${cols[4].replace(/"/g, '')}</td>
                        <td class="score">${cols[5] ? cols[5].replace(/"/g, '') : '0'}</td>
                    `;
                    tableBody.appendChild(tr);
                }
            });
        } catch (err) {
            errorMsg.style.display = 'block';
            errorMsg.innerText = "Sync Error: Make sure your Google Sheet has data in the 'Players' tab.";
            console.error(err);
        }
    }

    loadFantasyData();
</script>
</body>
</html>
